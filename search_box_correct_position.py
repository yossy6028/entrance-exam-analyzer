#!/usr/bin/env python3
"""
æ¤œç´¢çª“ã®æ­£ç¢ºãªä½ç½®ã‚’ã‚¯ãƒªãƒƒã‚¯
"""
import pyautogui
import time
import subprocess

def search_box_correct_position():
    """æ¤œç´¢çª“ã®æ­£ç¢ºãªä½ç½®ã‚’ã‚¯ãƒªãƒƒã‚¯"""
    
    print("ğŸ” æ¤œç´¢çª“ã‚’æ­£ç¢ºã«ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™")
    
    # bunkoOCRã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
    subprocess.run(["osascript", "-e", 'tell application "bunkoOCR" to activate'])
    time.sleep(1)
    
    # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‹ã‚‰è¦‹ãŸæ¤œç´¢çª“ã®ä½ç½®
    # è™«çœ¼é¡ã‚¢ã‚¤ã‚³ãƒ³ã®å³å´ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰éƒ¨åˆ†
    print("\n1ï¸âƒ£ æ¤œç´¢çª“ã‚’ã‚¯ãƒªãƒƒã‚¯...")
    # æ¤œç´¢çª“ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰éƒ¨åˆ†ã‚’æ­£ç¢ºã«ã‚¯ãƒªãƒƒã‚¯
    pyautogui.click(700, 39)  # ã‚ˆã‚Šæ­£ç¢ºãªåº§æ¨™
    time.sleep(0.5)
    
    # ã‚¯ãƒªãƒƒã‚¯ãŒã†ã¾ãã„ã‹ãªã„å ´åˆã¯ã€è™«çœ¼é¡ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    print("2ï¸âƒ£ è™«çœ¼é¡ã‚¢ã‚¤ã‚³ãƒ³ã‚‚ã‚¯ãƒªãƒƒã‚¯...")
    pyautogui.click(530, 39)  # è™«çœ¼é¡ã‚¢ã‚¤ã‚³ãƒ³
    time.sleep(0.5)
    
    # ã‚¿ãƒ–ã‚­ãƒ¼ã§æ¤œç´¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ç§»å‹•
    print("3ï¸âƒ£ ã‚¿ãƒ–ã‚­ãƒ¼ã§æ¤œç´¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸...")
    pyautogui.press('tab')
    time.sleep(0.5)
    
    # ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
    print("4ï¸âƒ£ æ¤œç´¢çª“ã‚’ã‚¯ãƒªã‚¢...")
    pyautogui.hotkey('cmd', 'a')
    pyautogui.press('delete')
    
    # 25ã‚’å…¥åŠ›
    print("5ï¸âƒ£ ã€Œ25ã€ã‚’å…¥åŠ›...")
    pyautogui.typewrite('25')
    time.sleep(1)
    
    print("\nâœ… æ¤œç´¢çª“ã«ã€Œ25ã€ã‚’å…¥åŠ›ã—ã¾ã—ãŸ")

if __name__ == "__main__":
    search_box_correct_position()